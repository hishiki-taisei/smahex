<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMASH HEX</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/test.css') }}">
</head>
<body>
    <h1>SMASH HEX </h1>

    {# --- サイズ選択UI (変更) --- #}
    <div class="size-selector">
        {% for size_key, option in size_options.items() %}
            <a href="{{ option.url }}"
               class="size-button {{ 'active-size' if option.is_active else '' }}">
                {{ option.display_name }}
            </a>
        {% endfor %}
    </div>
    {# ランダム生成ボタンのリンク先を変更 #}
    <a href="{{ url_for('random_generate', size=current_size_key) }}" class="new-board-button">ランダム生成</a>
    {# --- ここまで変更 --- #}

    {# --- ハニカムグリッド描画 (row_configに基づいて動的に生成) --- #}
    <div id="hex-grid" class="hex-grid-container">
        {# アイコンリストのインデックスを追跡するためのnamespace #}
        {% set icon_index = namespace(value=0) %}
        {# row_configリストをループして行を生成 #}
        {% for row_count in row_config %}
            {# 行ごとのセル数に応じてクラス名を動的に設定 #}
            <div class="hex-row hex-row-{{ row_count }}">
                {# その行のセル数だけループしてセルを生成 #}
                {% for _ in range(row_count) %}
                    {# 正しいインデックスのアイコンを取得 #}
                    {% if icon_index.value < icons|length %} {# 配列外参照を防ぐ #}
                        {% set icon = icons[icon_index.value] %}
                        <div class="hex-cell state-white" data-icon="{{ icon }}">
                            <div class="hex-content">
                                <img src="{{ url_for('static', filename='sma_icon/' + icon) }}" alt="{{ icon.split('.')[0] }}">
                            </div>
                        </div>
                        {# インデックスをインクリメント #}
                        {% set icon_index.value = icon_index.value + 1 %}
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>
    {# --- ハニカムグリッド描画ここまで --- #}


    <div class="controls">
        <button id="copy-button" data-share-url="{{ share_url }}">URLをコピー</button>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>