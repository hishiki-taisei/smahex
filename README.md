# SMASH HEX - Hexagonal Grid Generator

## 概要

SMASH HEX は、指定されたサイズと Seed 値に基づいて、スマブラのファイターアイコンが配置された六角形（ハニカム）グリッドを生成・共有できる Web アプリケーションです。盤面は URL で再現でき、マスをクリックすると色を切り替えてマークできます。

URL: https://smahex.vercel.app/

## 機能

- **六角形グリッドレイアウト**: 視認性の高いハニカムパターンで表示
- **複数のボードサイズ**: 5x5 / 6x6 / 7x7 / 8x8 をサポート（内部キー: small, medium, large, xlarge）
- **Seed ベース生成**: 同じ Seed と設定で同じ盤面を再現可能
- **ランダム生成**: 現在の設定を保ったまま新しい Seed で再生成
- **ファイター重複の許可/禁止**: 重複を許可すると同一アイコンが盤上に複数配置される
- **重複数ハイライト**: 重複数に応じて背景を銅/銀/金などで強調
- **同一アイコン連動**: 重複許可時は同じアイコンのマスが連動して色変更
- **ハンデ有重複up（重複ON時のみ）**:
  - 5重複・4重複・3重複のアイコンを必ず含む盤面を生成
  - それぞれの重複グループに「ジャ禁」「シ禁」「A禁」「B禁」から重複なしで1つのラベルを自動付与（ランダム）
  - ラベルは各該当マスにバッジとして表示（セル左下寄せ）
- **マス色の切替**:
  - 通常モード: デフォルト → 赤 → 青 → デフォルト
  - 3色モード: デフォルト → 赤 → 青 → 緑 → デフォルト
- **URL 共有**: 現在の盤面（サイズ/Seed/重複設定）を URL としてコピー

## 前提条件

- Python 3.6 以上
- `app/static/sma_icon/` にキャラクターアイコン（.png 推奨）を配置
  - 重複を禁止する場合、選択した盤面サイズ以上のアイコン枚数が必要（最大 8x8 = 64）
  - 重複を許可する場合、1 枚以上あれば生成可能

## インストール

```bash
git clone https://github.com/hishiki-taisei/smahex.git
cd smahex
pip install -r requirements.txt
```

## 実行方法（ローカル）

```bash
python app/app.py
# ブラウザで http://127.0.0.1:5000/ を開く
```

## 使い方

1. **サイズ選択**: 5x5 / 6x6 / 7x7 / 8x8 の中から選択
2. **ランダム生成**: 現在のサイズ・重複設定のまま新しい Seed で再生成
3. **Seed 指定**: 任意の数値を入力して盤面を再現
4. **ファイター重複**: チェック ON で重複を許可（ハイライトと連動色変更が有効）
   - 重複OFF時は「ハンデ有重複up」が無効になり、ラベルに斜線が表示されます
5. **ハンデ有重複up**: 重複ONのときだけ選択可能。5/4/3重複を保証し、各グループにラベルを付与
6. **3色モード**: ON で 緑 を含む 3 色循環（デフォルト → 赤 → 青 → 緑）
7. **URL をコピー**: 共有可能なリンクをクリップボードにコピー

補足
- 初回アクセス時は「ファイター重複」がONで開始します
- ランダム生成やサイズ切替を行っても、各チェックボックスの状態はURLに反映され保持されます

## URL パラメータ（例）

- `seed`: 数値（例: `1234`）
- `size`: `small` | `medium` | `large` | `xlarge`
 - `allow_duplicates`: `on` | `off`（重複許可のON/OFF）
 - `handicap_up`: `on` | `off`（ハンデ有重複upのON/OFF。`allow_duplicates=on`時のみ有効）

例:
- `/view?seed=1234&size=small&allow_duplicates=on&handicap_up=on`
- `/view?seed=5678&size=large&allow_duplicates=off&handicap_up=off`

制約
- ハンデ有重複upは盤面サイズが12以上（5+4+3）でのみ成立します

## デプロイ

このアプリは Vercel でのデプロイに対応しています（`vercel.json` を使用）。Python ランタイムは `@vercel/python` を利用し、静的ファイルは `/app/static/*` をルーティングしています。

## ライセンス / 謝辞

- アイコン素材元: https://w.atwiki.jp/smashsp_kensyou/pages/47.html#google_vignette
- 本リポジトリに含まれるアイコン画像は各素材提供元の利用規約に従います。
